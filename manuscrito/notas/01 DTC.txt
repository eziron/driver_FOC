En un proyecto final de carrera, como el que estás realizando para conseguir el título de "ingeniero de ejecución en electrónica", es fundamental hacer un uso adecuado de las referencias para asegurar la originalidad y la integridad académica de tu trabajo. Aquí tienes algunas recomendaciones sobre cómo referenciar adecuadamente:

1. **Parafraseo y Citas Directas**: 
   - **Parafraseo**: En lugar de hacer un copy-paste de las fuentes, es preferible que parafrasees la información. Esto significa que debes leer y entender el contenido y luego explicarlo con tus propias palabras, siempre citando la fuente original.
   - **Citas Directas**: Si hay fragmentos específicos que quieres incluir tal cual, usa comillas y cita la fuente directamente. Sin embargo, las citas directas deben ser limitadas y usadas solo cuando sea absolutamente necesario.

2. **Uso de Referencias**:
   - **Libros y Artículos**: Puedes referenciar libros, artículos académicos y otros documentos relevantes para explicar conceptos teóricos como el control FOC (Field-Oriented Control). Asegúrate de seguir el formato de citación recomendado por tu institución (APA, IEEE, etc.).
   - **Documentación Técnica**: También puedes referenciar documentación técnica de fabricantes de componentes o software que estés utilizando.

3. **Estructura y Propósito**:
   - **Contexto**: Introduce brevemente los conceptos teóricos en tu propio trabajo y luego proporciona referencias para que el lector pueda consultar la fuente original para más detalles.
   - **Integración**: Asegúrate de que las referencias y las citas se integren de manera fluida en tu proyecto, complementando y apoyando tu propia investigación y análisis.

4. **Bibliografía y Citaciones**:
   - **Bibliografía**: Incluye una sección de bibliografía o referencias al final de tu proyecto donde listes todas las fuentes que has consultado.
   - **Citaciones en el Texto**: Utiliza citaciones en el texto para indicar cuándo estás utilizando información de una fuente externa.

5. **Originalidad y Contribución Propia**:
   - **Aporte Personal**: Asegúrate de que una parte significativa del trabajo refleje tu propio análisis, experimentación y resultados. La sección de teoría debe apoyar tu trabajo práctico y no ser el enfoque principal.

### Ejemplo de Referencia:

Supongamos que estás explicando el control FOC. Podrías parafrasear y referenciar de la siguiente manera:

---

En el control orientado al campo (FOC), el objetivo es controlar de manera independiente los componentes de corriente directa y cuadratura del motor brushless, permitiendo un control preciso del torque y la velocidad. Según *Smith y Johnson (2020)*, esta técnica optimiza el rendimiento del motor al minimizar las pérdidas de energía y mejorar la respuesta dinámica. La implementación de FOC requiere el uso de transformaciones matemáticas como la transformada de Park y la de Clarke, que convierten las corrientes de referencia en el sistema de coordenadas del estator al sistema de coordenadas del rotor (*Smith y Johnson, 2020*).

Referencias:
- Smith, A., & Johnson, B. (2020). *Advanced Motor Control Techniques*. New York: Academic Press.

---

De esta manera, estás integrando la información de la fuente con tu propio texto y proporcionando una referencia clara para que los lectores puedan consultar el trabajo original si lo desean.

----------------
%este es el fragemtno del documento en el que estoy trabajando actualmente


\chapter{Estado del Arte}

%este es la seccion dando un repaso sobre el control trapezoidal, sirve de referencia para lo que quiero en la explicacion de DTC
\section{Control Trapezoidal}
El control trapezoidal, también llamado control de 6 pasos, es sin duda alguna el control más sencillo en términos de complejidad de algoritmo y requerimientos de hardware para el control de motores BLDC.

Este control se basa en seguir una secuencia de 6 pasos. En cada paso de la secuencia se polariza solo uno de los devanados del estator. Es decir, se deja una fase polarizada en positivo, una fase polarizada en negativo y otra fase apagada o en alta impedancia. Esta distribución es la que da origen a los 6 pasos. Cada paso se mantiene por 60 grados de giro y cada fase se mantiene polarizada por 120 grados \cite{fisher2014high}.

Para realizar el cambio de fase, lo más común es el uso de las señales BEMF (Back Electromotive Force o fuerza electromotriz de retorno, por sus siglas en inglés). A esta forma de control trapezoidal se le denomina sensorless o sin sensor. Las señales de BEMF son relativamente sencillas de obtener utilizando una serie de resistencias en estrella para obtener un neutro virtual del bobinado y comparadores de voltaje para la detección del pulso en cada fase \cite{shao2003direct}. La desventaja es que estos pulsos a bajas velocidades son demasiado tenues para ser detectados, por lo que el motor debe realizar un arranque en lazo abierto para llegar a la velocidad mínima necesaria para tener pulsos de BEMF detectables de forma estable y desde ahí poder hacer el control en lazo cerrado, dando como resultado que estos motores tengan un casi nulo torque para el arranque, además de tiempos de arranque bastante altos \cite{Gualtieri2018}.

Como solución a esto, se puede agregar el uso de sensores Hall ubicados estratégicamente frente a los imanes del rotor, con el fin de poder identificar en qué paso de la secuencia se encuentra el rotor. A esta configuración se le denomina sensored o con sensor, aunque es posible volver al uso de las señales BEMF después de cierta velocidad, ya que estas señales sufren menos latencia a alta velocidad que los sensores Hall.

De forma opcional, este control puede tener medición de corriente de la fuente de alimentación. Aunque esta medición solo se usa con fines de protección contra sobrecorriente y no tiene ningún efecto sobre el control de lazo cerrado estando dentro del límite establecido.

La mayor desventaja del control trapezoidal es su alto rizado en el torque del motor, lo que da como resultado un motor con baja eficiencia y precisión. Pero su sencillez y bajo coste lo hace ideal para su uso en radio controlados de pequeña escala como drones o autos \cite{juanpere_tecnicas}.

\section{Control DTC}
%esta es la seccion que quiero completar

---------------

los siguientes son fracmentos de textos extraidos de diferentes fuentes, realcionado al control FOC de motores BLDC

%Inicio Referencia power_conv_00 
\cite[pp. 310-314]{power_conv_00}

\section{Direct Torque Control}
Direct torque control (DTC) is one of the advanced control schemes for ac drives [5-7]. It is characterized by simple control algorithm, easy digital implementation and robust operation [8, 9]. In this section, the principle of DTC scheme is introduced and simulation results are provided.

\subsection{Principle of Direct Torque Control}
The electromagnetic torque developed by an induction motor can be expressed in a number of ways, one of which is

\begin{equation}
T_e = \frac{3P}{2} \frac{L_m}{\sigma L_s L_r} \lambda_s \lambda_r \sin \theta_r \tag{14.8-1}
\end{equation}

where $\theta_r$ is the angle between the stator flux vector $\vec{\lambda_s}$ and rotor flux vector $\vec{\lambda_r}$, often known as torque angle. This equation indicates that $T_e$ can be directly controlled by $\theta_r$.

The main variable to be controlled in the DTC scheme is the stator flux vector $\vec{\lambda_s}$. Referring to the induction motor model of Fig. 14.3-2b, $\vec{\lambda_s}$ relates the stator voltage vector $\vec{v_s}$ by

\begin{equation}
p \vec{\lambda_s} = \vec{v_s} - R_s \vec{i_s} \tag{14.8-2}
\end{equation}

The equation shows that the derivative of $\vec{\lambda_s}$ reacts instantly to changes in $\vec{v_s}$. As discussed in Chapter 6, the stator voltage $\vec{v_s}$, which is the inverter output voltage, can be controlled by the reference vector $\vec{V_{ref}}$ in the space vector modulation. Since $\vec{V_{ref}}$ is synthesized by the stationary voltage vectors of the inverter, a proper selection of the stationary vectors can make the magnitude and angle of $\vec{\lambda_s}$ adjustable.

\begin{figure}[h]
\centering
\includegraphics{graficos/img23.jpg}
\caption{Figure 14.8-1: Principle of direct torque control.}
\label{fig:14.8-1}
\end{figure}
\FloatBarrier

Figure 14.8-1 shows the principle of direct torque control for a two-level VSI-fed induction motor drive. The $dq$-axis plane for the stator flux $\vec{\lambda_s}$ is divided into six sectors I to VI. The stator flux $\vec{\lambda_s}$ in the figure falls into sector I, and its angle $\theta_s$ is referenced to the d-axis of the stationary reference frame. The rotor flux vector $\vec{\lambda_r}$ lags $\vec{\lambda_s}$ by $\theta_r$.

Let’s now examine the impact of the stationary voltage vectors $\vec{V_0}$ to $\vec{V_6}$ on $\vec{\lambda_s}$ and $\theta_r$. Assume that $\vec{\lambda_s}$ and $\theta_r$ in Fig. 14.8-1 are the initial stator flux vector and torque angle. When voltage vector $\vec{V_2}$ is selected, the stator flux vector will become $\vec{\lambda_s}' = \vec{\lambda_s} + \vec{V_2}\Delta t$ after a short time interval $\Delta t$, leading to an increase in flux magnitude ($\lambda_s' > \lambda_s$) and torque angle ($\theta_r' > \theta_r$). If voltage vector $\vec{V_5}$ is selected, $\vec{\lambda_s}$ will change to $\vec{\lambda_s}'' = \vec{\lambda_s} + \vec{V_5}\Delta t$, causing a decrease in flux magnitude ($\lambda_s'' < \lambda_s$) and torque angle ($\theta_r'' < \theta_r$). Similarly, the selection of $\vec{V_3}$ and $\vec{V_6}$ can make one variable increase and the other decrease. Therefore, $\lambda_s$ and $\theta_r$ can be controlled separately by proper selection of the inverter voltage vectors.

Note that the changes in $\vec{v_s}$ have much less impact on $\vec{\lambda_r}$ for a short time interval $\Delta t$ due to the large rotor time constant. Therefore, it is assumed in the above analysis that the rotor flux vector $\vec{\lambda_r}$ is kept constant during $\Delta t$.

\subsection{Switching Logic}

\begin{figure}[h]
\centering
\includegraphics{graficos/img24.jpg}
\caption{Figure 14.8-2: Block diagram of direct torque control scheme.}
\label{fig:14.8-2}
\end{figure}
\FloatBarrier

Figure 14.8-2 shows a typical block diagram of a DTC-based induction motor drive, where the rotor speed feedback loop is not shown for simplicity. Similar to the FOC schemes, the stator flux and electromagnetic torque are controlled separately to achieve superior dynamic performance. The stator flux reference $\lambda_s^*$ is compared with the calculated stator flux $\lambda_s$, and the error $\Delta \lambda_s$ is sent to Flux Comparator. The torque reference $T_e^*$ is compared with the calculated torque $T_e$, and their difference $\Delta T_e$ is the input of Torque Comparator. The output of the flux and torque comparators ($\chi_\lambda$ and $\chi_T$) are sent to Switching Logic unit for proper selection of the voltage vectors (switching states) of the inverter.

\begin{figure}[h]
\centering
\includegraphics{graficos/img25.jpg}
\caption{Figure 14.8-3: Characteristics of hysteresis comparators.}
\label{fig:14.8-3}
\end{figure}
\FloatBarrier

Both flux and torque comparators are of a hysteresis (tolerance band) type, whose transfer characteristics are shown in Fig. 14.8-3. The flux comparator has two output levels ($\chi_\lambda = +1$ and $-1$) while the torque comparator has three output levels ($\chi_T = +1, 0$ and $-1$), where "+1" requests an increase in $\lambda_s$ or $\theta_r$, "-1" demands a decrease in $\lambda_s$ or $\theta_r$, and "0" signifies no changes. The tolerance band for the flux and torque comparators is $\delta_\lambda$ and $\delta_T$, respectively.

\begin{figure}[h]
\centering
\caption{Table 14.8-1: Switching Logic for $\vec{\lambda_s}^*$ Rotating in the Counterclockwise Direction.}
\includegraphics[scale=0.4]{graficos/tabla_14_8_1.png}
\label{tab:14.8-1}
\end{figure}
\FloatBarrier

Table 14.8-1 gives the switching logic for the stator flux reference $\vec{\lambda_s}^*$ rotating in the counterclockwise direction. The input variables are $\chi_\lambda$, $\chi_T$, and the sector number, and the output variables are the inverter voltage vectors. The output of the comparators decides which voltage vector should be selected. Assuming that $\vec{\lambda_s}^*$ is in sector I, the comparator output of $\chi_\lambda = \chi_T = +1$ signifies an increase in $\lambda_s$ and $T_e$. Voltage vector $\vec{V_2}$ can then be selected from the table. This selection will make both $\lambda_s$ and $\theta_r$ increase as shown in Fig. 14.8-1.

When the output of the torque comparator $\chi_T$ is zero (no need to adjust $T_e$), zero vector $\vec{V_0}$ can be selected. The alternative use of the switching states [OOO] and [PPP] for $\vec{V_0}$ in the switching table can help to reduce the device switching frequency. For instance, when $\chi_T$ changes between ‘+1’ and ‘0’ or between ‘0’ and ‘-1’, the zero states in the table ensures that only two switches are involved during the transition, one being turned on and the other being turned off.

\begin{figure}[h]
\centering
\includegraphics{graficos/img26.jpg}
\caption{Figure 14.8-4: Trajectories of the stator flux $\vec{\lambda_s}$ and its reference $\vec{\lambda_s}^*$ with $\chi_T = 1$.}
\label{fig:14.8-4}
\end{figure}
\FloatBarrier

The operation of the direct torque control can be further explained by the stator flux trajectory diagram of Fig. 14.8-4. Assume that the reference vector $\vec{\lambda_s}^*$ rotates in the counterclockwise direction during rotor speed acceleration and the output of the torque comparator is $\chi_T = +1$. When $\lambda_s$ reaches the outer band limit at point $a$ in sector II, the output of the flux comparator $\chi_\lambda$ becomes ‘-1’, and vector $\vec{V_4}$ is selected from the switching table, which will cause a decrease in $\lambda_s$. When $\lambda_s$ hits the inner band limit at point $b$, $\chi_\lambda$ becomes +1, and vector $\vec{V_3}$ is selected, making an increase in $\lambda_s$. The trajectory of $\vec{\lambda_s}$ in the figure is not very smooth due to the wide width of the tolerance band $\delta_\lambda$, which translates into a high stator flux ripple and low switching frequency. The quality of the stator flux waveform can be improved by reducing $\delta_\lambda$, but it is achieved at the expense of an increase in the switching frequency.

\begin{figure}[h]
\centering
\caption{Table 14.8-2: Switching Logic for the Stator Flux Rotating in the Clockwise Direction}
\includegraphics[scale=0.4]{graficos/tabla_14_8_2.png}
\label{tab:14.8-2}
\end{figure}
\FloatBarrier

The switching logic given in Table 14.8-1 is only valid for the motor rotating in the counterclockwise direction. When the motor operates in the clockwise direction, the switching logic in Table 14.8-2 can be used.

\subsection{Stator Flux and Torque Calculation}

The stator flux vector $\vec{\lambda_s}$ in the stationary frame can be expressed as
\begin{equation}
    \vec{\lambda_s} = \lambda_{ds} + j\lambda_{qs} = \int (v_{ds} - R_s i_{ds}) \, dt + j \int (v_{qs} - R_s i_{qs}) \, dt \tag{14.8-3}
\end{equation}

from which its magnitude and angle are
\begin{equation}
    \lambda_s = \sqrt{\lambda_{ds}^2 + \lambda_{qs}^2} \tag{14.8-4}
\end{equation}
\begin{equation}
    \theta_s = \tan^{-1} \left( \frac{\lambda_{qs}}{\lambda_{ds}} \right) \tag{14.8-5}
\end{equation}
where $v_{ds}$, $v_{qs}$, $i_{ds}$, and $i_{qs}$ are the measured stator voltages and currents. The developed electromagnetic torque can be calculated by
\begin{equation}
    T_e = \frac{3P}{2} \left( i_{qs} \lambda_{ds} - i_{ds} \lambda_{qs} \right) \tag{14.8-6}
\end{equation}

The above equations illustrate that the stator flux and developed torque can be obtained by using measured stator voltages and currents. The only motor parameter required in the calculations is the stator resistance $R_s$. This is in contrast to the direct rotor flux FOC schemes, where almost all the motor parameters are needed.

\subsection{DTC Drive Simulation}

\begin{figure}[h]
\centering
\includegraphics{graficos/img27.jpg}
\caption{Simulated waveforms for a DTC drive operating at the rated rotor speed.}
\label{fig:14.8-5}
\end{figure}
\FloatBarrier

Figure 14.8-5 shows the simulated waveforms for an induction motor drive using the DTC scheme given in Fig. 14.8-2. The rotor speed feedback loop, based on which the torque reference $T_e^*$ is generated, is not shown for simplicity. The motor parameters used in the simulation are given in Table 14.5-1.

The tolerance bands $\delta_T$ and $\delta_\lambda$ for the torque and flux comparators are adjusted such that average switching frequency $f_{sw}$ of the switching devices is around 800 Hz. The stator flux reference $\lambda_s^*$ is set to its rated value of 9.0 Wb.

The motor operates at the rated speed of $n_r = 1189$ rpm under no-load conditions. Assuming that the load torque $T_L$ is suddenly increased to its rated value of 7490 N·m at $t = 0.1$ s and then decreased to 1000 N·m at $t = 0.3$ s, the generated torque $T_e$ responds quickly. The torque ripple is set by the torque tolerance band $\delta_T$. The stator current $i_{as}$ varies with $T_e$ accordingly.

Since the stator flux $\lambda_s$ and the motor torque $T_e$ are controlled independently, $\lambda_s$ is kept constant during the sudden load torque changes. To demonstrate the effectiveness of the stator flux control, its reference $\lambda_s^*$ has a step reduction from its rated value of 9.0 Wb to 6.3 Wb at $t = 0.5$ s. The stator flux $\lambda_s$ responds quickly while the stator current $i_{as}$ is adjusted accordingly to keep $T_e$ constant. The sector number obtained from the sector number generator in Fig. 14.8-2 is also shown in the figure.

\begin{figure}[h]
\centering
\includegraphics{graficos/img28.jpg}
\caption{Trajectories of the stator flux $\lambda_s$ in Fig. 14.8-5 for $0.35 \leq t \leq 0.75$ s.}
\label{fig:14.8-6}
\end{figure}
\FloatBarrier

Figure 14.8-6 shows the trajectories of the stator flux $\lambda_s$ in Fig. 14.8-5 for $0.35 \leq t \leq 0.75$ s. The outer and inner trajectories correspond to the steady-state operation before and after the stator flux reduction at $t = 0.5$ s.

%fin referencia power_conv_00

-----------------------------

%Inicio Referencia fisher2014high 
\cite[pp. 5-8]{fisher2014high}

### 2.2 Vector Control

Over the past decade, research into the high performance control of brushless DC motors and permanent magnet synchronous motors has focussed on two competing methodologies: Field Oriented Control (FOC) and Direct Torque Control (DTC). Both FOC and DTC are forms of vector control and aim to effectively control certain motor parameters directly in order to force the motor to the application setting regardless of external conditions. Proponents of each methodology claim superiority over the other and each method (in terms of performance) is indisputably superior to legacy DC motor control methods (scalar control). However, each control strategy does have distinct advantageous and disadvantageous which need to be considered (Merzoug & Naceri, 2008).

**2.2.2 Direct Torque Control Functional Overview**

Realistically, DTC is the only competition to FOC in terms of performance motor control for brushless DC machines. Fundamentally, DTC aims to control the flux linkage and electromagnetic torque directly by changing the relative angle between the stator flux and the permanent magnet flux vectors. (Garcia, et al., n.d.) DTC directly controls motor torque by rapidly manipulating the stator flux vector orientation by changing the voltage provided to the motor stator windings.

DTC operates by comparing reference (application set) values of the stator flux and torque with observed values. Hence, the only feedback parameters required for DTC are the torque and flux (\(T\) and \(\Psi\)) which are derived directly from the stator flux linkage. The stator flux linkage is estimated by the equation \(\Psi_s = \int (v_a - R_a i_a) dt\) where \(\Psi_s\) is the estimated stator flux vector, \(v_a\) is the measured stator voltage vector, \(R_a\) is the stator resistance and \(i_a\) is the stator current vector (Inoue, et al., 2011). DTC does not require rotor speed or position information to achieve torque control and is considered an inherently sensorless control scheme.

![Figure 6. DTC Control Scheme for PMSM (Paturca, et al., 2006)](image)

Figure 6 above provides a basic operational overview of DTC. It can be seen that DTC requires a torque and stator flux vector estimator, a look-up table (switching table) and hysteresis comparators (Paturca, et al., 2006). At each sample time, the stator currents \(i_a\) and \(i_b\) as well as the DC-bus voltage are sampled. Using these values and the manufacturer data for the stator resistance, the stator flux is calculated in the \(\alpha, \beta\) reference frame. By nature, the stator flux is rotating, ideally, with the rotor. Referring to Figure 7 below, DTC breaks the full stator flux rotation into six possible discrete ‘inverter voltage vectors’ (Paturca, et al., 2006). The calculated \(\alpha - \beta\) components of the stator flux are used to determine the ‘sector’ (\(S_1 - S_6\)) in which the current flux vector is located.

![Figure 7. Inverter voltage vectors and stator flux vectors (Paturca, et al., 2006)](image)

The magnitude of the stator flux and electromagnetic torque is then calculated and compared with reference values in the relative hysteresis comparators (see Figure 6). Finally, the output of the comparators with the current flux vector ‘sector’ is fed to a lookup table and the appropriate inverter voltage vector is selected. No PWM is required with DTC, instead, PWM is replaced with a simple lookup table.

Many variations of DTC exist, but all are based on the general principals outlined above. Like FOC, DTC has seen implementation in both PMSM and BLDC motor drives with the former being more common. DTC is often employed for large machine drives but currently has not been employed in any commercially available small DC machine electronic speed controllers.

%fin referencia fisher2014high

--------------------

%Inicio Referencia Bida2018
\cite{Bida2018}

### Direct Torque Control Techniques

In the mid-1980s, vector control techniques alternative to FOC were developed. M. Depenbrock suggested a technique titled as Direct Torque Control with Hexagonal flux trajectory [9], while I. Takahashi and T. Noguchi suggested Direct Torque Control with Circular flux trajectory [8]. 

DTC circuits have simpler structures than the FOC circuit, they do not require the use of an inverter with PWM, a speed sensor and reference frame transformers. All calculations are performed in the stator reference frame as information about the exact position of the rotor in such systems is not required (except the start-up case of the synchronous motor). The requirements for the computational capabilities of the controllers are relatively low. Such systems have high-quality dynamic characteristics, quickly respond to load changes, and are less sensitive to changes in motor parameters and disturbances. However, their steady-state operation is characterized by high ripples levels of the stator current, flux linkage and torque, especially at low speeds, that greatly limits their use for high-precision drives. At the same time, DTC with Circular flux trajectory occurs to be more effective for controlling traction drives, according to [11].

Direct Torque Control with Space Vector Modulation (DTC with SVM) is designed to overcome the disadvantages of DTC. DTC with SVM uses the pulse width modulation approach to generate the voltage. There are several variations of the circuits that significantly improve the efficiency of the control system, compared to DTC. They provide a certain reduction in the ripple of torque and flux, the control is carried out more smoothly, and start-up and running the motor at low speeds are more stable. At the same time, having high dynamics, this technique still remains incapable of ensuring the accuracy of control provided by FOC [16].

Linear Direct Torque Control (Linear DTC) and Sliding Mode DTC (SM DTC). In the theory of automatic control, the Feedback Linearization approach is used to represent a nonlinear system as a linear one, in order to simplify the control process. All the FOC circuits use this approach which is implemented through the transformation of the stator current components from αβ to dq-reference frame, while traditional DTC techniques do not use the linearization.

Work [10] suggests direct torque control techniques using linearized mathematical model of the motor based on the DTC with SVM circuit. Depending on the used torque and flux controllers, Linear DTC (PI-controllers) and Sliding Mode DTC (Sliding Mode controllers) are distinguished. According to the simulation results presented in [10], it can be concluded that both proposed approaches provide a significant minimization of flux and torque ripples typical for DTC, while the system's response speed remains high, just as in case of the DTC with SVM. Also, the stability of the system against changes of the motor parameters or disturbances is increased. Nevertheless, at low speeds, ripples remain clearly noticeable, that limits the application of these techniques for high-precision drives.

%fin referencia Bida2018
